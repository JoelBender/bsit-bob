# Debug Samples

There are two debugging samples, one with the defaults and another adding an
additional handler to a submodule.

## debug-001.py

This application first prints out the loggers, their levels and handlers:

```python
print(f"{os.getenv('BOB_LOG') = }")

logging.basicConfig(level=logging.WARNING)
print(f"{logging.root} level={logging.root.level} handlers={logging.root.handlers}")

x = logging.getLogger("bob")
print(f"{x} level={x.level} handlers={x.handlers}")

y = logging.getLogger("bob.core")
print(f"{y} level={y.level} handlers={y.handlers}")
print()
```

### First Run

Running the application prints this:

```text
os.getenv('BOB_LOG') = None
<RootLogger root (WARNING)> level=30 handlers=[<StreamHandler <stderr> (NOTSET)>]
<Logger bob (WARNING)> level=0 handlers=[]
<Logger bob.core (WARNING)> level=0 handlers=[]
```

By default the root logger is set to WARNING and the default stream handler
prints everything it gets to `stderr`.  When using the `logging.debug()` methods
only those that are WARNING or above will generate output.

At this point the `bob` and `bob.core` loggers are in their default
configuration.

Continuing with the rest of the application, after importing `bob` it will
print out the loggers again with this output:

```text
<Logger bob (DEBUG)> level=10 handlers=[<NullHandler (NOTSET)>]
<Logger bob.core (DEBUG)> level=0 handlers=[]
```

The `bob` logger (found in `bob.core.bob_logger`) has had its level set to
DEBUG which changes its effective level from WARNING that it inherited from
the root logger to DEBUG.  It has had a `NullHandler` added to prevent output
being generated by the `logging.lastResort` when `logging.basicConfig()` has
_not_ been called.

The `bob` logger has `propagate` turned off.  This means that for handlers to
get events from `bob` or any of its children the handler needs to be explicitly
added to `bob`.

Because `bob` has been set to DEBUG the effective level of the child loggers
will also be DEBUG until they are set to something different.

### Second Run

Running the application with the BOB_LOG environment variable set to DEBUG
results in this output, along with all the other debugging output during
the initialization of Bob:

```text
<Logger bob (DEBUG)> level=10 handlers=[<StreamHandler <stderr> (DEBUG)>]
<Logger bob.core (DEBUG)> level=0 handlers=[]
```

Now the `bob` logger has a `StreamHandler` with the default formatter rather
than the `NullHandler`.  All of the debugging output from any of it children
will also be generated, so in the debugging output is this line generated
when the instance was created:

```text
DEBUG:bob.equipment.hvac.valve:TwoWayActuatedOnOffValve.__init__ ...
```

### Third Run

The BOB\_DEBUG\_FILENAME environment variable is given a file name and all
of the debugging output will be directed to a `FileHandler` such as:

```text
<Logger bob (DEBUG)> level=10 handlers=[<FileHandler .../debug-001.txt (DEBUG)>]
```

## debug-002.py

This application is identical to the first one with an additional handler added
to a specific `bob...` logger.

### First Run

The logging formatter has the added prefix to distinguish between the output of
this specific logger:

```python
z = logging.StreamHandler()
z.setFormatter(logging.Formatter("@@ " + logging.BASIC_FORMAT, None))
z.setLevel(logging.DEBUG)

y = logging.getLogger("bob.equipment.hvac.valve")
y.addHandler(z)
print(f"{y} level={y.level} handlers={y.handlers}")
```

Now the debugging output will have the special prefix and the generated output
will include both the `__init__()` of the requested class and its superclass
from the same module:

```text
@@ DEBUG:bob.equipment.hvac.valve:TwoWayActuatedOnOffValve.__init__ ...
@@ DEBUG:bob.equipment.hvac.valve:TwoWayActuatedValve.__init__ ...
```

### Second Run

Running the application with the BOB_LOG environment variable set to DEBUG
results in duplicated output, the first from the submodule specific logger and
the second from the one added to the `bob` logger:

```text
@@ DEBUG:bob.equipment.hvac.valve:TwoWayActuatedOnOffValve.__init__ {'equipment': {('actuator', <class 'bob.equipment.hvac.actuator.ElectricalOnOffActuator'>): {}, ('valve', <class 'bob.equipment.hvac.valve.TwoWayValve'>): {}}, 'properties': {}} {'label': 'valve'}
DEBUG:bob.equipment.hvac.valve:TwoWayActuatedOnOffValve.__init__ {'equipment': {('actuator', <class 'bob.equipment.hvac.actuator.ElectricalOnOffActuator'>): {}, ('valve', <class 'bob.equipment.hvac.valve.TwoWayValve'>): {}}, 'properties': {}} {'label': 'valve'}
```


